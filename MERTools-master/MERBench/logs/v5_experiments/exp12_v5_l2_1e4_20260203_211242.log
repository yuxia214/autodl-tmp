====== Params Pre-analysis =======
args:  Namespace(audio_feature='chinese-hubert-large-UTT', batch_size=32, contrastive_temperature=0.07, contrastive_weight=0.1, cross_kl_weight=0.01, dataset='MER2023', debug=False, dropout=0.35, e2e_dim=None, e2e_name=None, early_stopping_patience=30, epochs=100, feat_scale=1, feat_type='utt', focal_gamma=2.0, fusion_temperature=1.0, gate_alpha=0.5, gpu=0, grad_clip=1.0, hidden_dim=128, hyper_path=None, kl_warmup_epochs=20, kl_weight=0.01, l2=0.0001, label_smoothing=0.1, lr=0.0005, lr_adjust='case1', lr_factor=0.5, lr_patience=10, mixup_alpha=0.4, modality_dropout=0.15, modality_dropout_warmup=20, model='attention_robust_v5', n_classes=None, num_attention_heads=4, num_workers=0, print_iters=100000000.0, recon_weight=0.1, save_iters=100000000.0, save_root='./saved-trimodal', savemodel=False, test_dataset=None, text_feature='Baichuan-13B-Base-UTT', train_dataset=None, use_contrastive=True, use_dynamic_kl=True, use_gated_fusion=True, use_mixup=False, use_modality_dropout=True, use_proxy_attention=True, use_vae=True, video_feature='clip-vit-large-patch14-UTT')
====== Reading Data =======
train: sample number 3373
audio feature root: /root/autodl-tmp/MERTools-master/MERBench/dataset/mer2023-dataset-process/features/chinese-hubert-large-UTT
  0%|          | 0/3373 [00:00<?, ?it/s]  6%|▌         | 187/3373 [00:00<00:01, 1859.70it/s] 11%|█         | 373/3373 [00:00<00:02, 1202.35it/s] 15%|█▌        | 507/3373 [00:00<00:02, 1240.40it/s] 19%|█▉        | 640/3373 [00:00<00:02, 1252.99it/s] 23%|██▎       | 787/3373 [00:00<00:01, 1318.46it/s] 27%|██▋       | 923/3373 [00:00<00:01, 1324.72it/s] 31%|███▏      | 1059/3373 [00:00<00:01, 1329.09it/s] 36%|███▌      | 1200/3373 [00:00<00:01, 1352.66it/s] 40%|███▉      | 1345/3373 [00:01<00:01, 1378.55it/s] 45%|████▍     | 1505/3373 [00:01<00:01, 1443.25it/s] 49%|████▉     | 1651/3373 [00:01<00:01, 1144.14it/s] 53%|█████▎    | 1776/3373 [00:01<00:01, 1155.69it/s] 58%|█████▊    | 1944/3373 [00:01<00:01, 1293.07it/s] 63%|██████▎   | 2140/3373 [00:01<00:00, 1473.50it/s] 68%|██████▊   | 2295/3373 [00:01<00:00, 1489.10it/s] 73%|███████▎  | 2449/3373 [00:01<00:00, 1493.49it/s] 77%|███████▋  | 2602/3373 [00:01<00:00, 1197.16it/s] 81%|████████  | 2734/3373 [00:02<00:00, 1219.56it/s] 86%|████████▌ | 2899/3373 [00:02<00:00, 1330.61it/s] 90%|█████████ | 3051/3373 [00:02<00:00, 1381.07it/s] 95%|█████████▍| 3196/3373 [00:02<00:00, 1382.35it/s]100%|██████████| 3373/3373 [00:02<00:00, 1349.54it/s]
Input feature chinese-hubert-large-UTT ===> dim is (1, 1024)
  0%|          | 0/3373 [00:00<?, ?it/s]  2%|▏         | 69/3373 [00:00<00:04, 688.43it/s]  4%|▍         | 142/3373 [00:00<00:04, 711.14it/s]  8%|▊         | 261/3373 [00:00<00:03, 923.71it/s] 11%|█▏        | 380/3373 [00:00<00:02, 1028.15it/s] 14%|█▍        | 483/3373 [00:00<00:02, 1021.25it/s] 19%|█▉        | 634/3373 [00:00<00:02, 1185.63it/s] 22%|██▏       | 753/3373 [00:00<00:02, 1172.41it/s] 26%|██▌       | 874/3373 [00:00<00:02, 1184.00it/s] 30%|██▉       | 1009/3373 [00:00<00:01, 1235.28it/s] 35%|███▍      | 1173/3373 [00:01<00:01, 1355.29it/s] 40%|███▉      | 1341/3373 [00:01<00:01, 1453.28it/s] 44%|████▍     | 1487/3373 [00:01<00:01, 1150.91it/s] 48%|████▊     | 1612/3373 [00:01<00:01, 1160.08it/s] 51%|█████▏    | 1735/3373 [00:01<00:01, 949.11it/s]  55%|█████▍    | 1841/3373 [00:01<00:01, 964.47it/s] 58%|█████▊    | 1946/3373 [00:01<00:01, 982.95it/s] 61%|██████▏   | 2067/3373 [00:01<00:01, 1041.87it/s] 65%|██████▍   | 2177/3373 [00:02<00:01, 1048.73it/s] 68%|██████▊   | 2301/3373 [00:02<00:00, 1101.35it/s] 72%|███████▏  | 2437/3373 [00:02<00:00, 1172.13it/s] 76%|███████▌  | 2557/3373 [00:02<00:00, 1177.75it/s] 80%|████████  | 2711/3373 [00:02<00:00, 1282.67it/s] 85%|████████▍ | 2856/3373 [00:02<00:00, 1329.64it/s] 89%|████████▊ | 2991/3373 [00:02<00:00, 1331.83it/s] 93%|█████████▎| 3141/3373 [00:02<00:00, 1100.68it/s] 99%|█████████▉| 3334/3373 [00:02<00:00, 1309.59it/s]100%|██████████| 3373/3373 [00:02<00:00, 1163.59it/s]
Input feature Baichuan-13B-Base-UTT ===> dim is (1, 5120)
  0%|          | 0/3373 [00:00<?, ?it/s]  3%|▎         | 105/3373 [00:00<00:03, 1041.70it/s]  9%|▊         | 292/3373 [00:00<00:02, 1522.94it/s] 13%|█▎        | 445/3373 [00:00<00:01, 1506.82it/s] 19%|█▊        | 631/3373 [00:00<00:01, 1643.60it/s] 24%|██▎       | 796/3373 [00:00<00:01, 1617.37it/s] 30%|██▉       | 1003/3373 [00:00<00:01, 1371.94it/s] 34%|███▍      | 1148/3373 [00:00<00:01, 1369.14it/s] 38%|███▊      | 1290/3373 [00:00<00:01, 1359.63it/s] 42%|████▏     | 1430/3373 [00:01<00:01, 1091.45it/s] 46%|████▌     | 1557/3373 [00:01<00:01, 1129.48it/s] 50%|█████     | 1703/3373 [00:01<00:01, 1202.34it/s] 59%|█████▉    | 1986/3373 [00:01<00:00, 1626.17it/s] 65%|██████▍   | 2187/3373 [00:01<00:00, 1729.17it/s] 71%|███████   | 2402/3373 [00:01<00:00, 1846.91it/s] 79%|███████▉  | 2661/3373 [00:01<00:00, 2054.69it/s] 86%|████████▌ | 2901/3373 [00:01<00:00, 2154.42it/s] 93%|█████████▎| 3121/3373 [00:01<00:00, 2165.50it/s]100%|██████████| 3373/3373 [00:02<00:00, 1685.12it/s]
Input feature clip-vit-large-patch14-UTT ===> dim is (1, 768)
test1: sample number 411
audio feature root: /root/autodl-tmp/MERTools-master/MERBench/dataset/mer2023-dataset-process/features/chinese-hubert-large-UTT
  0%|          | 0/411 [00:00<?, ?it/s] 44%|████▎     | 179/411 [00:00<00:00, 1786.28it/s]100%|██████████| 411/411 [00:00<00:00, 2129.06it/s]
Input feature chinese-hubert-large-UTT ===> dim is (1, 1024)
  0%|          | 0/411 [00:00<?, ?it/s] 35%|███▌      | 145/411 [00:00<00:00, 1448.30it/s] 77%|███████▋  | 317/411 [00:00<00:00, 1607.33it/s]100%|██████████| 411/411 [00:00<00:00, 1918.20it/s]
Input feature Baichuan-13B-Base-UTT ===> dim is (1, 5120)
  0%|          | 0/411 [00:00<?, ?it/s] 68%|██████▊   | 278/411 [00:00<00:00, 2744.41it/s]100%|██████████| 411/411 [00:00<00:00, 3830.08it/s]
Input feature clip-vit-large-patch14-UTT ===> dim is (1, 768)
test2: sample number 412
audio feature root: /root/autodl-tmp/MERTools-master/MERBench/dataset/mer2023-dataset-process/features/chinese-hubert-large-UTT
  0%|          | 0/412 [00:00<?, ?it/s] 54%|█████▍    | 223/412 [00:00<00:00, 2210.90it/s]100%|██████████| 412/412 [00:00<00:00, 2109.60it/s]
Input feature chinese-hubert-large-UTT ===> dim is (1, 1024)
  0%|          | 0/412 [00:00<?, ?it/s] 36%|███▋      | 150/412 [00:00<00:00, 1496.45it/s]100%|██████████| 412/412 [00:00<00:00, 3396.56it/s]
Input feature Baichuan-13B-Base-UTT ===> dim is (1, 5120)
  0%|          | 0/412 [00:00<?, ?it/s] 50%|█████     | 208/412 [00:00<00:00, 2075.01it/s]100%|██████████| 412/412 [00:00<00:00, 2132.69it/s]
Input feature clip-vit-large-patch14-UTT ===> dim is (1, 768)
test3: sample number 834
audio feature root: /root/autodl-tmp/MERTools-master/MERBench/dataset/mer2023-dataset-process/features/chinese-hubert-large-UTT
  0%|          | 0/834 [00:00<?, ?it/s]  6%|▌         | 50/834 [00:00<00:01, 498.41it/s] 19%|█▊        | 155/834 [00:00<00:00, 821.95it/s] 29%|██▊       | 238/834 [00:00<00:01, 571.73it/s] 61%|██████    | 509/834 [00:00<00:00, 1235.61it/s] 80%|████████  | 671/834 [00:00<00:00, 1349.67it/s]100%|██████████| 834/834 [00:00<00:00, 1363.48it/s]
Input feature chinese-hubert-large-UTT ===> dim is (1, 1024)
  0%|          | 0/834 [00:00<?, ?it/s]  5%|▌         | 42/834 [00:00<00:01, 418.77it/s] 22%|██▏       | 183/834 [00:00<00:00, 998.14it/s] 35%|███▌      | 296/834 [00:00<00:00, 1057.13it/s] 48%|████▊     | 402/834 [00:00<00:00, 1048.17it/s] 65%|██████▍   | 538/834 [00:00<00:00, 1158.58it/s] 81%|████████  | 676/834 [00:00<00:00, 1232.62it/s] 96%|█████████▌| 800/834 [00:00<00:00, 1217.93it/s]100%|██████████| 834/834 [00:00<00:00, 1049.84it/s]
Input feature Baichuan-13B-Base-UTT ===> dim is (1, 5120)
  0%|          | 0/834 [00:00<?, ?it/s] 18%|█▊        | 148/834 [00:00<00:00, 1478.31it/s] 48%|████▊     | 402/834 [00:00<00:00, 2098.98it/s] 77%|███████▋  | 641/834 [00:00<00:00, 2222.28it/s]100%|██████████| 834/834 [00:00<00:00, 2655.94it/s]
Input feature clip-vit-large-patch14-UTT ===> dim is (1, 768)
train&val folder:5; test sets:3
audio dimension: 1024; text dimension: 5120; video dimension: 768
====== Training and Evaluation =======
>>>>> Cross-validation: training on the 1 folder >>>>>
Step1: build model (each folder has its own model)
/root/miniconda3/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:60: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Step2: training (multiple epoches)
epoch:1; metric:emoval; train:-0.2719; eval:0.0981; lr:0.000500
epoch:2; metric:emoval; train:0.1414; eval:0.3627; lr:0.000500
epoch:3; metric:emoval; train:0.3795; eval:0.4803; lr:0.000500
