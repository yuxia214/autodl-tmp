{"version":3,"file":"dragmove.js","sources":["../../../../../src/editor/extensions/ext-overview_window/dragmove/dragmove.js"],"sourcesContent":["// https://github.com/knadh/dragmove.js\n// Kailash Nadh (c) 2020.\n// MIT License.\n// can't use npm version as the dragmove is different.\n\nlet _loaded = false\nconst _callbacks = []\nconst _isTouch = window.ontouchstart !== undefined\n\nexport const dragmove = function (target, handler, parent, onStart, onEnd, onDrag) {\n  // Register a global event to capture mouse moves (once).\n  if (!_loaded) {\n    document.addEventListener(_isTouch ? 'touchmove' : 'mousemove', function (e) {\n      let c = e\n      if (e.touches) {\n        c = e.touches[0]\n      }\n\n      // On mouse move, dispatch the coords to all registered callbacks.\n      for (let i = 0; i < _callbacks.length; i++) {\n        _callbacks[i](c.clientX, c.clientY)\n      }\n    })\n  }\n\n  _loaded = true\n  let isMoving = false; let hasStarted = false\n  let startX = 0; let startY = 0; let lastX = 0; let lastY = 0\n\n  // On the first click and hold, record the offset of the pointer in relation\n  // to the point of click inside the element.\n  handler.addEventListener(_isTouch ? 'touchstart' : 'mousedown', function (e) {\n    e.stopPropagation()\n    e.preventDefault()\n    if (target.dataset.dragEnabled === 'false') {\n      return\n    }\n\n    let c = e\n    if (e.touches) {\n      c = e.touches[0]\n    }\n\n    isMoving = true\n    startX = target.offsetLeft - c.clientX\n    startY = target.offsetTop - c.clientY\n  })\n\n  // On leaving click, stop moving.\n  document.addEventListener(_isTouch ? 'touchend' : 'mouseup', function () {\n    if (onEnd && hasStarted) {\n      onEnd(target, parent, parseInt(target.style.left), parseInt(target.style.top))\n    }\n\n    isMoving = false\n    hasStarted = false\n  })\n\n  // On leaving click, stop moving.\n  document.addEventListener(_isTouch ? 'touchmove' : 'mousemove', function () {\n    if (onDrag && hasStarted) {\n      onDrag(target, parseInt(target.style.left), parseInt(target.style.top))\n    }\n  })\n\n  // Register mouse-move callback to move the element.\n  _callbacks.push(function move (x, y) {\n    if (!isMoving) {\n      return\n    }\n\n    if (!hasStarted) {\n      hasStarted = true\n      if (onStart) {\n        onStart(target, lastX, lastY)\n      }\n    }\n\n    lastX = x + startX\n    lastY = y + startY\n\n    // If boundary checking is on, don't let the element cross the viewport.\n    if (target.dataset.dragBoundary === 'true') {\n      if (lastX < 1 || lastX >= window.innerWidth - target.offsetWidth) {\n        return\n      }\n      if (lastY < 1 || lastY >= window.innerHeight - target.offsetHeight) {\n        return\n      }\n    }\n\n    target.style.left = lastX + 'px'\n    target.style.top = lastY + 'px'\n  })\n}\n\nexport { dragmove as default }\n"],"names":[],"mappings":"AAKA,IAAI,UAAU;AACd,MAAM,aAAa,CAAA;AACnB,MAAM,WAAW,OAAO,iBAAiB;AAE7B,MAAC,WAAW,SAAU,QAAQ,SAAS,QAAQ,SAAS,OAAO,QAAQ;AAEjF,MAAI,CAAC,SAAS;AACZ,aAAS,iBAAiB,WAAW,cAAc,aAAa,SAAU,GAAG;AAC3E,UAAI,IAAI;AACR,UAAI,EAAE,SAAS;AACb,YAAI,EAAE,QAAQ,CAAC;AAAA,MACjB;AAGA,eAAS,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK;AAC1C,mBAAW,CAAC,EAAE,EAAE,SAAS,EAAE,OAAO;AAAA,MACpC;AAAA,IACF,CAAC;AAAA,EACH;AAEA,YAAU;AACV,MAAI,WAAW;AAAO,MAAI,aAAa;AACvC,MAAI,SAAS;AAAG,MAAI,SAAS;AAAG,MAAI,QAAQ;AAAG,MAAI,QAAQ;AAI3D,UAAQ,iBAAiB,WAAW,eAAe,aAAa,SAAU,GAAG;AAC3E,MAAE,gBAAe;AACjB,MAAE,eAAc;AAChB,QAAI,OAAO,QAAQ,gBAAgB,SAAS;AAC1C;AAAA,IACF;AAEA,QAAI,IAAI;AACR,QAAI,EAAE,SAAS;AACb,UAAI,EAAE,QAAQ,CAAC;AAAA,IACjB;AAEA,eAAW;AACX,aAAS,OAAO,aAAa,EAAE;AAC/B,aAAS,OAAO,YAAY,EAAE;AAAA,EAChC,CAAC;AAGD,WAAS,iBAAiB,WAAW,aAAa,WAAW,WAAY;AACvE,QAAI,SAAS,YAAY;AACvB,YAAM,QAAQ,QAAQ,SAAS,OAAO,MAAM,IAAI,GAAG,SAAS,OAAO,MAAM,GAAG,CAAC;AAAA,IAC/E;AAEA,eAAW;AACX,iBAAa;AAAA,EACf,CAAC;AAGD,WAAS,iBAAiB,WAAW,cAAc,aAAa,WAAY;AAC1E,QAAI,UAAU,YAAY;AACxB,aAAO,QAAQ,SAAS,OAAO,MAAM,IAAI,GAAG,SAAS,OAAO,MAAM,GAAG,CAAC;AAAA,IACxE;AAAA,EACF,CAAC;AAGD,aAAW,KAAK,SAAS,KAAM,GAAG,GAAG;AACnC,QAAI,CAAC,UAAU;AACb;AAAA,IACF;AAEA,QAAI,CAAC,YAAY;AACf,mBAAa;AACb,UAAI,SAAS;AACX,gBAAQ,QAAQ,OAAO,KAAK;AAAA,MAC9B;AAAA,IACF;AAEA,YAAQ,IAAI;AACZ,YAAQ,IAAI;AAGZ,QAAI,OAAO,QAAQ,iBAAiB,QAAQ;AAC1C,UAAI,QAAQ,KAAK,SAAS,OAAO,aAAa,OAAO,aAAa;AAChE;AAAA,MACF;AACA,UAAI,QAAQ,KAAK,SAAS,OAAO,cAAc,OAAO,cAAc;AAClE;AAAA,MACF;AAAA,IACF;AAEA,WAAO,MAAM,OAAO,QAAQ;AAC5B,WAAO,MAAM,MAAM,QAAQ;AAAA,EAC7B,CAAC;AACH;"}